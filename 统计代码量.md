http://hittyt.iteye.com/blog/1700584

今天面试时，突然被面试官问到怎样用shell命令搞定某个文件夹下java代码行数的统计。
想了一下，基本思路就是找到这个文件夹下面的所有java文件，然后每个文件统计一下代码，外层套个for循环，叠加一下结果，就拿到想要的结果了。
不过显然面试官希望我用一句shell搞定，当场晕菜了，没搞定。回来想了一下，其实确实不是啥太难的问题。
 
最粗略版

find . -name "*.java"|xargs wc -l|grep "total"|awk '{print $1}'  
find . -name "*.java"|xargs cat|wc -l    #Output:37634  
上面的两句效果一样，只不过第二种是先利用cat将多个java文件的内容合并输出了。然后再统计。
不过两个都有共同的毛病——连文件里面的空行都给统计进去算作一行了。
去除空行版

find . -name "*.java"|xargs cat|grep -v ^$|wc -l    #Output:36335  
这个版本靠谱一些了，可以看到去掉空行之后的统计结果变为了：36335，比上个版本干掉了1299行的空行。。。 
但是，java代码还有注释呢啊？！Fuck，还得干掉注释！
去除注释版

#exclude the lines begin with 

find . -name "*.java"|xargs cat|grep -v -e ^$ -e ^\s*\/\/.*$|wc -l 

好，这个方法发现，以//开头的注释有36335-36064=271行。这里需要注意的是，注释行未必就以//作为开头，可能N个空格之后才开始的的//，所以匹配时需要加上上面的^\s*放在开头。
大功告成啦？扯淡！！！
java里面注释好几种风格，再给你看看这个非常常见的注释，还是会在统计结果里面

咋搞？这种注释我还真没想好怎么方便的除去，简单粗暴的方法但是可以在上面grep的参数里面再加入3个正则，分别去除以/**、*、*/开头的行。不过我自己想着都觉得挫。不知道有没有更好的办法了。

